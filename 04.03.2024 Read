Я попытался выполнить все требования. Не смог сделать, чтобы не было обработки событий в code-behind. Тест вынесен в отдельную сборку.
