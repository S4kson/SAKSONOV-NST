Я попытался выполнить все требования. Не смог сделать, чтобы не было обработки событий в code-behind. Всё остальное было реализовано, либо исправлено. Тест вынесен в отдельную сборку.
